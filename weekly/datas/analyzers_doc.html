<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="orientdbPHP static analysis report by Exakat (https://www.exakat.io/) ">
  <meta name="generator" content="Exakat 1.1.7 (build 698)">
  <title>Analyzers' documentation, by Exakat</title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">

  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <!-- Place favicon.ico in the root directory -->

  <link rel="stylesheet" href="styles/vendor.css">

  <link rel="stylesheet" href="styles/main.css">
  
  <script src="scripts/vendor/modernizr.js"></script>

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body class="hold-transition skin-yellow-light sidebar-mini">
  <div class="wrapper">

    <!-- Main Header -->
    <header class="main-header">

      <!-- Logo -->
      <a href="index.html" class="logo">
        <!-- mini logo for sidebar mini 50x50 pixels -->
        <span class="logo-mini"><b>O</b></span>
        <!-- logo for regular state and mobile devices -->
        <span class="logo-lg">orientdb</span>
      </a>

      <!-- Header Navbar -->
      <nav class="navbar navbar-static-top" role="navigation">
        <!-- Sidebar toggle button-->
        <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
          <span class="sr-only">Toggle navigation</span>
        </a>
      </nav>
    </header>
    <!-- Left side column. contains the logo and sidebar -->
    <aside class="main-sidebar">

      <!-- sidebar: style can be found in sidebar.less -->
      <section class="sidebar">
                <!-- Sidebar Menu -->
        <ul class="sidebar-menu">
          <li class="header">&nbsp;</li>
          <!-- Optionally, you can add icons to the links -->
          <li class="active"><a href="index.html"><i class="fa fa-dashboard"></i> <span>Dashboard</span></a></li>
          <li><a href="weekly.html"><i class="fa fa-flag"></i> <span>Weekly</span></a></li>
          <li class="treeview">
            <a href="#"><i class="fa fa-sticky-note-o"></i> <span>Annexes</span><i class="fa fa-angle-left pull-right"></i></a>
            <ul class="treeview-menu">
              <li><a href="annex_settings.html"><i class="fa fa-circle-o"></i>Analyzer Settings</a></li>
              <li><a href="analyzers_doc.html"><i class="fa fa-circle-o"></i>Analyzers Documentation</a></li>
              <li><a href="codes.html"><i class="fa fa-circle-o"></i>Codes</a></li>
              <li><a href="credits.html"><i class="fa fa-circle-o"></i>Credits</a></li>
            </ul>
          </li>
        </ul>
        <!-- /.sidebar-menu -->
      </section>
      <!-- /.sidebar -->
    </aside>

    <!-- Content Wrapper. Contains page content -->
    <div id="main">
      <div class="content-wrapper" id="ajax-content">
        <!-- Main content -->
        <!-- Content Header (Page header) -->
                <!-- Content Header (Page header) -->
        <section class="content-header">
          <h1>
            Analyzers Documentation
          </h1>
        </section>

        <!-- Main content -->
        <section id="used_settings" class="content">
          <div class="box">
            <div class="box-body">
              <div class="row">
                <div class="col-xs-12">
                  <h2><a href="issues.html?analyzer=Direct Injection" id="Direct Injection">Direct Injection</a></h2><p>[Since 0.8.4] - [ -P Security/DirectInjection ]</p><p>The following code act directly upon PHP incoming variables like $_GET and $_POST. This make those snippet very unsafe.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #FF8000">//&nbsp;Direct&nbsp;injection<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">Hello</span><span style="color: #007700">.</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'user'</span><span style="color: #007700">].,&nbsp;</span><span style="color: #0000BB">welcome</span><span style="color: #007700">.;<br /><br /></span><span style="color: #FF8000">//&nbsp;less&nbsp;direct&nbsp;injection<br /></span><span style="color: #0000BB">foo</span><span style="color: #007700">(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'user'</span><span style="color: #007700">]);<br />function&nbsp;</span><span style="color: #0000BB">foo</span><span style="color: #007700">(</span><span style="color: #0000BB">$user</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">Hello</span><span style="color: #007700">.</span><span style="color: #0000BB">$user</span><span style="color: #007700">.,&nbsp;</span><span style="color: #0000BB">welcome</span><span style="color: #007700">.;<br />}<br /><br /></span>?&gt;</pre><br />
<br />
</p><h2><a href="issues.html?analyzer=Avoid sleep()/usleep()" id="Avoid sleep()/usleep()">Avoid sleep()/usleep()</a></h2><p>[Since 0.8.4] - [ -P Security/NoSleep ]</p><p>sleep() and usleep() help saturate the web server. <br />
<br />
Pausing the script for a specific amount of time means that the Web server is also making all related ressources sleep, such as database, sockets, session, etc. This may used to set up a DOS on the server.  <br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br />$begin&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">microtime</span><span style="color: #007700">(</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">checkLogin</span><span style="color: #007700">(</span><span style="color: #0000BB">$user</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$password</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$end&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">microtime</span><span style="color: #007700">(</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Making&nbsp;all&nbsp;login&nbsp;checks&nbsp;looks&nbsp;the&nbsp;same<br /></span><span style="color: #0000BB">usleep</span><span style="color: #007700">(</span><span style="color: #0000BB">1000000&nbsp;</span><span style="color: #007700">-&nbsp;(</span><span style="color: #0000BB">$end&nbsp;</span><span style="color: #007700">-&nbsp;</span><span style="color: #0000BB">$begin</span><span style="color: #007700">)&nbsp;*&nbsp;</span><span style="color: #0000BB">1000000</span><span style="color: #007700">);&nbsp;<br /><br /></span><span style="color: #FF8000">//&nbsp;Any&nbsp;hit&nbsp;on&nbsp;this&nbsp;page&nbsp;now&nbsp;uses&nbsp;1&nbsp;second,&nbsp;no&nbsp;matter&nbsp;if&nbsp;load&nbsp;is&nbsp;high&nbsp;or&nbsp;not<br />//&nbsp;Is&nbsp;it&nbsp;now&nbsp;possible&nbsp;to&nbsp;saturate&nbsp;the&nbsp;webserver&nbsp;in&nbsp;1&nbsp;s&nbsp;?&nbsp;<br /><br /></span>?&gt;</pre><br />
<br />
As much as possible, avoid delaying the end of the script. <br />
<br />
sleep() and usleep() have less impact in commandline (CLI).<br />
</p><h2><a href="issues.html?analyzer=parse_str() Warning" id="parse_str() Warning">parse_str() Warning</a></h2><p>[Since 0.8.4] - [ -P Security/parseUrlWithoutParameters ]</p><p>The parse_str() function parses a query string and assigns the resulting variables to the local scope. This may create a unexpected number of variables, and even overwrite the existing one.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br />&nbsp;&nbsp;</span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">foo</span><span style="color: #007700">(&nbsp;)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$a</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$a</span><span style="color: #007700">;<br />&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;</span><span style="color: #0000BB">parse_str</span><span style="color: #007700">(</span><span style="color: #DD0000">'a=1'</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;No&nbsp;second&nbsp;parameter<br />&nbsp;&nbsp;</span><span style="color: #0000BB">foo</span><span style="color: #007700">(&nbsp;);<br />&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;displays&nbsp;1<br /></span>?&gt;</pre><br />
<br />
Always use an empty variable a second parameter to parse_str(), so as to collect the incoming values, and then, filter them in that array. <br />
</p><p>This rule is named <a target="_blank" href="https://github.com/dseguy/clearPHP/blob/master/rules/know-your-variables.md">know-your-variables</a>, in the clearPHP reference.</p><h2><a href="issues.html?analyzer=Avoid Those Hash Functions" id="Avoid Those Hash Functions">Avoid Those Hash Functions</a></h2><p>[Since 0.8.4] - [ -P Security/AvoidThoseCrypto ]</p><p>The following cryptographic algorithms are considered unsecure, and should be replaced with new and more performant algorithms. <br />
<br />
MD2, MD4, MD5, SHA0, SHA1, CRC, DES, 3DES, RC2, RC4. <br />
<br />
When possible, avoid using them, may it be as PHP functions, or hashing function configurations (mcrypt, hash...).<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #FF8000">//&nbsp;Weak&nbsp;cryptographic&nbsp;algorithm<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">md5</span><span style="color: #007700">(</span><span style="color: #DD0000">'The&nbsp;quick&nbsp;brown&nbsp;fox&nbsp;jumped&nbsp;over&nbsp;the&nbsp;lazy&nbsp;dog.'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Weak&nbsp;crypotgraphic&nbsp;algorthim,&nbsp;used&nbsp;with&nbsp;a&nbsp;modern&nbsp;PHP&nbsp;extension&nbsp;(easier&nbsp;to&nbsp;update)<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">hash</span><span style="color: #007700">(</span><span style="color: #DD0000">'md5'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'The&nbsp;quick&nbsp;brown&nbsp;fox&nbsp;jumped&nbsp;over&nbsp;the&nbsp;lazy&nbsp;dog.'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Strong&nbsp;crypotgraphic&nbsp;algorthim,&nbsp;used&nbsp;with&nbsp;a&nbsp;modern&nbsp;PHP&nbsp;extension<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">hash</span><span style="color: #007700">(</span><span style="color: #DD0000">'sha156'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'The&nbsp;quick&nbsp;brown&nbsp;fox&nbsp;jumped&nbsp;over&nbsp;the&nbsp;lazy&nbsp;dog.'</span><span style="color: #007700">);<br /><br /></span>?&gt;</pre><br />
<br />
Weak crypto are commonly used for hashing values when caching them. In such cases, security is not a primary concern. However, it may later become such, when hackers get access to the cache folders, or if the cached identifier is published. As a preventive protection, it is recommended to always use a secure hashing function.<br />
<br />
See also <a href="https://en.wikipedia.org/wiki/Secure_Hash_Algorithms" alt="Secure Hash Algorithms">Secure Hash Algorithms</a>.<br />
</p><h2><a href="issues.html?analyzer=Should Use Prepared Statement" id="Should Use Prepared Statement">Should Use Prepared Statement</a></h2><p>[Since 0.8.4] - [ -P Security/ShouldUsePreparedStatement ]</p><p>Modern databases provides support for prepared statement : it separates the query from the processed data and highten significantly the security. <br />
<br />
Building queries with concatenations is not recommended, though not always avoidable. When possible, use prepared statements.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /></span><span style="color: #FF8000">/*&nbsp;Execute&nbsp;a&nbsp;prepared&nbsp;statement&nbsp;by&nbsp;passing&nbsp;an&nbsp;array&nbsp;of&nbsp;values&nbsp;*/<br /><br /></span><span style="color: #0000BB">$sql&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'SELECT&nbsp;name,&nbsp;colour,&nbsp;calories<br />&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;fruit<br />&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;calories&nbsp;&lt;&nbsp;:calories&nbsp;AND&nbsp;colour&nbsp;=&nbsp;:colour'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$sth&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$conn</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">prepare</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #0000BB">PDO</span><span style="color: #007700">::</span><span style="color: #0000BB">ATTR_CURSOR&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">PDO</span><span style="color: #007700">::</span><span style="color: #0000BB">CURSOR_FWDONLY</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">execute</span><span style="color: #007700">(array(</span><span style="color: #DD0000">':calories'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">150</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">':colour'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #DD0000">'red'</span><span style="color: #007700">));<br /></span><span style="color: #0000BB">$red&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$sth</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">fetchAll</span><span style="color: #007700">();<br /></span>?&gt;</pre><br />
<br />
Same code, without preparation : <br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br />&nbsp;&nbsp;&nbsp;&nbsp;$sql&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'SELECT&nbsp;name,&nbsp;color,&nbsp;calories&nbsp;FROM&nbsp;fruit&nbsp;WHERE&nbsp;calories&nbsp;&lt;&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$conn</span><span style="color: #007700">-</span><span style="color: #0000BB">quote</span><span style="color: #007700">(</span><span style="color: #0000BB">150</span><span style="color: #007700">).</span><span style="color: #DD0000">'&nbsp;AND&nbsp;colour&nbsp;=&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$conn</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">quotes</span><span style="color: #007700">(</span><span style="color: #DD0000">'red'</span><span style="color: #007700">).</span><span style="color: #DD0000">'&nbsp;ORDER&nbsp;BY&nbsp;name'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$sth&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$conn</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">query</span><span style="color: #007700">(</span><span style="color: #0000BB">$sql</span><span style="color: #007700">)&nbsp;as&nbsp;</span><span style="color: #0000BB">$row</span><span style="color: #007700">);<br />}<br /></span>?&gt;</pre><br />
</p><h2><a href="issues.html?analyzer=Compare Hash" id="Compare Hash">Compare Hash</a></h2><p>[Since 0.8.4] - [ -P Security/CompareHash ]</p><p>When comparing hash values, it is important to use the strict comparison : === or !==. <br />
<br />
In a number of situations, the hash value will start with '0e', and PHP will understand that the comparison involves integers : it will then convert the strings into numbers, and it may end up converting them to 0.<br />
<br />
Here is an example <br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #FF8000">//&nbsp;The&nbsp;two&nbsp;following&nbsp;passwords&nbsp;hashes&nbsp;matches,&nbsp;while&nbsp;they&nbsp;are&nbsp;not&nbsp;the&nbsp;same.&nbsp;<br /></span><span style="color: #0000BB">$hashed_password&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0e462097431906509000000000000</span><span style="color: #007700">;<br />if&nbsp;(</span><span style="color: #0000BB">hash</span><span style="color: #007700">(</span><span style="color: #DD0000">'md5'</span><span style="color: #007700">,</span><span style="color: #DD0000">'240610708'</span><span style="color: #007700">,</span><span style="color: #0000BB">false</span><span style="color: #007700">)&nbsp;==&nbsp;</span><span style="color: #0000BB">$hashed_password</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;print&nbsp;</span><span style="color: #0000BB">Matched</span><span style="color: #007700">.\</span><span style="color: #0000BB">n</span><span style="color: #007700">;<br />}<br /></span>?&gt;</pre><br />
<br />
You may also use password_hash() and password_verify(). <br />
<br />
See also <a href="https://blog.whitehatsec.com/magic-hashes/" alt="Magic Hashes">Magic Hashes</a>.<br />
<br />
</p><p>This rule is named <a target="_blank" href="https://github.com/dseguy/clearPHP/blob/master/rules/strict-comparisons.md">strict-comparisons</a>, in the clearPHP reference.</p><h2><a href="issues.html?analyzer=preg_replace With Option e" id="preg_replace With Option e">preg_replace With Option e</a></h2><p>[Since 0.8.4] - [ -P Structures/pregOptionE ]</p><p>preg_replace() supported the /e option until PHP 7.0. It allowed the use of eval()'ed expression as replacement. This has been dropped in PHP 7.0, for security reasons.<br />
<br />
preg_replace() with /e option may be replaced with preg_replace_callback() and a closure, or preg_replace_callback_array() and an array of closures.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #FF8000">//&nbsp;preg_replace&nbsp;with&nbsp;/e<br /></span><span style="color: #0000BB">$string&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'abcde'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;PHP&nbsp;5.6&nbsp;and&nbsp;older&nbsp;usage&nbsp;of&nbsp;/e<br /></span><span style="color: #0000BB">$replaced&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'/c/e'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'strtoupper(\$0)'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$string</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;PHP&nbsp;7.0&nbsp;and&nbsp;more&nbsp;recent<br />//&nbsp;With&nbsp;one&nbsp;replacement<br /></span><span style="color: #0000BB">$replaced&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">preg_replace_callback</span><span style="color: #007700">(</span><span style="color: #DD0000">'/c/'</span><span style="color: #007700">,&nbsp;function&nbsp;(</span><span style="color: #0000BB">$x</span><span style="color: #007700">)&nbsp;{&nbsp;return&nbsp;</span><span style="color: #0000BB">strtoupper</span><span style="color: #007700">(</span><span style="color: #0000BB">$x</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]);&nbsp;},&nbsp;</span><span style="color: #0000BB">$string</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;With&nbsp;several&nbsp;replacements,&nbsp;preventing&nbsp;multiple&nbsp;calls&nbsp;to&nbsp;preg_replace_callback<br /></span><span style="color: #0000BB">$replaced&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">preg_replace_callback_array</span><span style="color: #007700">(array(</span><span style="color: #DD0000">'/c/'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;function&nbsp;(</span><span style="color: #0000BB">$x</span><span style="color: #007700">)&nbsp;{&nbsp;return&nbsp;</span><span style="color: #0000BB">strtoupper</span><span style="color: #007700">(</span><span style="color: #0000BB">$x</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]);&nbsp;},<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'/[a-b]/'&nbsp;</span><span style="color: #007700">=&gt;&nbsp;function&nbsp;(</span><span style="color: #0000BB">$x</span><span style="color: #007700">)&nbsp;{&nbsp;return&nbsp;</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$x</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]);&nbsp;}),&nbsp;</span><span style="color: #0000BB">$string</span><span style="color: #007700">);<br /></span>?&gt;</pre><br />
<br />
</p><h2><a href="issues.html?analyzer=Register Globals" id="Register Globals">Register Globals</a></h2><p>[Since 0.8.4] - [ -P Security/RegisterGlobals ]</p><p>register_globals was a PHP directive that dumped all incoming variables from GET, POST, COOKIE and FILES as global variables in the called scripts.<br />
This lead to security failures, as the variables were often used but not filtered. <br />
<br />
Though it is less often found in more recent code, register_globals is sometimes needed in legacy code, that haven't made the move to eradicate this style of coding.<br />
Backward compatible pieces of code that mimic the register_globals features usually create even greater security risks by being run after scripts startup. At that point, some important variables are already set, and may be overwritten by the incoming call, creating confusion in the script.<br />
<br />
Mimicking register_globals is achieved with variables variables, extract(), parse_str() and import_request_variables() (Up to PHP 5.4). <br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #FF8000">//&nbsp;Security&nbsp;warning&nbsp;!&nbsp;This&nbsp;overwrites&nbsp;existing&nbsp;variables.&nbsp;<br /></span><span style="color: #0000BB">extract</span><span style="color: #007700">(</span><span style="color: #0000BB">$_POST</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Security&nbsp;warning&nbsp;!&nbsp;This&nbsp;overwrites&nbsp;existing&nbsp;variables.&nbsp;<br /></span><span style="color: #007700">foreach(</span><span style="color: #0000BB">$_REQUEST&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$var&nbsp;</span><span style="color: #007700">=&gt;&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;$</span><span style="color: #0000BB">$var&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$value</span><span style="color: #007700">;<br />}<br /><br /></span>?&gt;</pre><br />
<br />
</p><h2><a href="issues.html?analyzer=Use random_int()" id="Use random_int()">Use random_int()</a></h2><p>[Since 0.8.4] - [ -P Php/BetterRand ]</p><p>rand() and mt_rand() should be replaced with random_int().<br />
<br />
At worse, rand() should be replaced with mt_rand(), which is a drop-in replacement and srand() by mt_srand(). <br />
<br />
random_int() replaces rand(), and has no seeding function like srand().<br />
<br />
Other sources of entropy that should be replaced by random_int() : microtime(), uniqid(), time(). Those a often combined with hashing functions and mixed with other sources of entropy, such as a salt.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #FF8000">//&nbsp;Avoid&nbsp;using&nbsp;this<br /></span><span style="color: #0000BB">$random&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">rand</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Drop-in&nbsp;replacement<br /></span><span style="color: #0000BB">$random&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">mt_rand</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Even&nbsp;better&nbsp;but&nbsp;different&nbsp;:&nbsp;<br />//&nbsp;valid&nbsp;with&nbsp;PHP&nbsp;7.0+<br /></span><span style="color: #007700">try&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$random&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">random_int</span><span style="color: #007700">(</span><span style="color: #0000BB">0</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">10</span><span style="color: #007700">);<br />}&nbsp;catch&nbsp;(\</span><span style="color: #0000BB">Exception&nbsp;$e</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;process&nbsp;case&nbsp;of&nbsp;not&nbsp;enoug&nbsp;random&nbsp;values<br /></span><span style="color: #007700">}<br /><br /></span><span style="color: #FF8000">//&nbsp;This&nbsp;is&nbsp;also&nbsp;a&nbsp;source&nbsp;of&nbsp;entropy,&nbsp;based&nbsp;on&nbsp;srand()<br />//&nbsp;It&nbsp;may&nbsp;simply&nbsp;be&nbsp;replaced&nbsp;by&nbsp;random_int()<br /></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">sha256</span><span style="color: #007700">(</span><span style="color: #0000BB">uniqid</span><span style="color: #007700">());<br /><br /></span>?&gt;</pre><br />
<br />
Since PHP 7, random_int() along with random_bytes(), provides cryptographically secure pseudo-random bytes, which are good to be used<br />
when security is involved. openssl_random_pseudo_bytes() may be used when the OpenSSL extension is available.<br />
<br />
See also <a href="http://php.net/manual/en/book.csprng.php" alt="CSPRNG">CSPRNG</a> and <a href="http://php.net/manual/en/book.openssl.php" alt="OpenSSL">OpenSSL</a>.<br />
</p><h2><a href="issues.html?analyzer=Safe Curl Options" id="Safe Curl Options">Safe Curl Options</a></h2><p>[Since 0.8.4] - [ -P Security/CurlOptions ]</p><p>It is advised to always use CURLOPT_SSL_VERIFYPEER and CURLOPT_SSL_VERIFYHOST when requesting a SSL connexion. <br />
<br />
With those tests (by default), the certificate is verified, and if it isn't valided, the connexion fails : this is a safe behavior.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br />$ch&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">curl_init</span><span style="color: #007700">();<br /><br /></span><span style="color: #0000BB">curl_setopt</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">CURLOPT_URL</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">https</span><span style="color: #007700">:</span><span style="color: #FF8000">//www.php.net/);<br /><br />//&nbsp;To&nbsp;be&nbsp;safe,&nbsp;always&nbsp;set&nbsp;this&nbsp;to&nbsp;true<br /></span><span style="color: #0000BB">curl_setopt</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">CURLOPT_SSL_VERIFYPEER</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">curl_exec</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">curl_close</span><span style="color: #007700">(</span><span style="color: #0000BB">$ch</span><span style="color: #007700">);<br /></span>?&gt;</pre><br />
<br />
</p><h2><a href="issues.html?analyzer=Hardcoded Passwords" id="Hardcoded Passwords">Hardcoded Passwords</a></h2><p>[Since 0.8.4] - [ -P Functions/HardcodedPasswords ]</p><p>Hardcoded passwords in the code. <br />
<br />
Hardcoding passwords is a bad idea. Not only it make the code difficult to change, but it is an information leak. It is better to hide this kind of information out of the code.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br />$ftp_server&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'300.1.2.3'</span><span style="color: #007700">;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;<br /></span><span style="color: #0000BB">$conn_id&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ftp_connect</span><span style="color: #007700">(</span><span style="color: #0000BB">$ftp_server</span><span style="color: #007700">);&nbsp;<br /><br /></span><span style="color: #FF8000">//&nbsp;login&nbsp;with&nbsp;username&nbsp;and&nbsp;password<br /></span><span style="color: #0000BB">$login_result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ftp_login</span><span style="color: #007700">(</span><span style="color: #0000BB">$conn_id</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'login'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'password'</span><span style="color: #007700">);&nbsp;<br /><br /></span>?&gt;</pre><br />
</p><p>This rule is named <a target="_blank" href="https://github.com/dseguy/clearPHP/blob/master/rules/no-hardcoded-credential.md">no-hardcoded-credential</a>, in the clearPHP reference.</p><h2><a href="issues.html?analyzer=No Hardcoded Port" id="No Hardcoded Port">No Hardcoded Port</a></h2><p>[Since 0.8.4] - [ -P Structures/NoHardcodedPort ]</p><p>When connecting to a remove server, port is an important information. It is recommended to make this configurable (with constant or configuration), to as to be able to change this value without changing the code.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Both&nbsp;configurable&nbsp;IP&nbsp;and&nbsp;hostname<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$connection&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ssh2_connect</span><span style="color: #007700">(</span><span style="color: #0000BB">$_ENV</span><span style="color: #007700">[</span><span style="color: #DD0000">'SSH_HOST'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$_ENV</span><span style="color: #007700">[</span><span style="color: #DD0000">'SSH_PORT'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$methods</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$callbacks</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Both&nbsp;hardcoded&nbsp;IP&nbsp;and&nbsp;hostname<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$connection&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ssh2_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'shell.example.com'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">22</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$methods</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$callbacks</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!</span><span style="color: #0000BB">$connection</span><span style="color: #007700">)&nbsp;die(</span><span style="color: #DD0000">'Connection&nbsp;failed'</span><span style="color: #007700">);<br /></span>?&gt;</pre><br />
<br />
</p><h2><a href="issues.html?analyzer=No Hardcoded Ip" id="No Hardcoded Ip">No Hardcoded Ip</a></h2><p>[Since 0.8.4] - [ -P Structures/NoHardcodedIp ]</p><p>Do not leave hard coded IP in your code.<br />
<br />
It is recommended to move such configuration in external files or databases, for each update. <br />
This may also come handy when testing. <br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #FF8000">//&nbsp;This&nbsp;IPv4&nbsp;is&nbsp;hardcoded.&nbsp;<br /></span><span style="color: #0000BB">$ip&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'183.207.224.50'</span><span style="color: #007700">;<br /></span><span style="color: #FF8000">//&nbsp;This&nbsp;IPv6&nbsp;is&nbsp;hardcoded.&nbsp;<br /></span><span style="color: #0000BB">$ip&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'2001:0db8:85a3:0000:0000:8a2e:0370:7334'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;This&nbsp;looks&nbsp;like&nbsp;an&nbsp;IP<br /></span><span style="color: #0000BB">$thisIsNotAnIP&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'213.187.99.50'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$thisIsNotAnIP&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'2133:1387:9393:5330'</span><span style="color: #007700">;<br /><br /></span>?&gt;</pre><br />
<br />
127.0.0.1, ::1 and ::0 are omitted, and not considered as a violation.<br />
<br />
</p><h2><a href="issues.html?analyzer=var_dump()... Usage" id="var_dump()... Usage">var_dump()... Usage</a></h2><p>[Since 0.8.4] - [ -P Structures/VardumpUsage ]</p><p>var_dump(), print_r() or var_export() should not be left in any production code. They are debugging functions.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">$error</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Debugging&nbsp;usage&nbsp;of&nbsp;var_dump<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;And&nbsp;major&nbsp;security&nbsp;problem&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">var_dump</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;This&nbsp;is&nbsp;OK&nbsp;:&nbsp;the&nbsp;$query&nbsp;is&nbsp;logged,&nbsp;and&nbsp;not&nbsp;displayed<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">log</span><span style="color: #007700">(</span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">$query</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">));<br />}<br /><br /></span>?&gt;</pre><br />
<br />
They may be tolerated during development time, but must be removed so as not to have any chance to be run in production.<br />
</p><p>This rule is named <a target="_blank" href="https://github.com/dseguy/clearPHP/blob/master/rules/no-debug-code.md">no-debug-code</a>, in the clearPHP reference.</p><h2><a href="issues.html?analyzer=No Hardcoded Hash" id="No Hardcoded Hash">No Hardcoded Hash</a></h2><p>[Since 0.8.4] - [ -P Structures/NoHardcodedHash ]</p><p>Hash should never be hardcoded. <br />
<br />
Hashes may be MD5, SHA1, SHA512, Bcrypt or any other. Such values must be easily changed, for security reasons, and the source code is not the safest place to hide it. <br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Those&nbsp;strings&nbsp;may&nbsp;be&nbsp;sha512&nbsp;hashes.&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;it&nbsp;is&nbsp;recomemdned&nbsp;to&nbsp;check&nbsp;if&nbsp;they&nbsp;are&nbsp;static&nbsp;or&nbsp;should&nbsp;be&nbsp;put&nbsp;into&nbsp;configuration<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$init512&nbsp;</span><span style="color: #007700">=&nbsp;array(&nbsp;</span><span style="color: #FF8000">//&nbsp;initial&nbsp;values&nbsp;for&nbsp;SHA512<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #DD0000">'6a09e667f3bcc908'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'bb67ae8584caa73b'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'3c6ef372fe94f82b'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'a54ff53a5f1d36f1'</span><span style="color: #007700">,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;);<br /><br /></span>?&gt;</pre><br />
<br />
</p><h2><a href="issues.html?analyzer=Random Without Try" id="Random Without Try">Random Without Try</a></h2><p>[Since 0.8.4] - [ -P Structures/RandomWithoutTry ] - [ PHP 7.0 and more recent ]</p><p>random_int() and random_bytes() require a try/catch structure around them.<br />
<br />
random_int() and random_bytes() emit Exceptions if they meet a problem. This way, failure can't be mistaken with returning an empty value, which leads to lower security. <br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #007700">try&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$salt&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">random_bytes</span><span style="color: #007700">(</span><span style="color: #0000BB">$length</span><span style="color: #007700">);<br />}&nbsp;catch&nbsp;(</span><span style="color: #0000BB">TypeError&nbsp;$e</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Error&nbsp;while&nbsp;reading&nbsp;the&nbsp;provided&nbsp;parameter<br /></span><span style="color: #007700">}&nbsp;catch&nbsp;(</span><span style="color: #0000BB">Exception&nbsp;$e</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Insufficient&nbsp;random&nbsp;data&nbsp;generated<br /></span><span style="color: #007700">}&nbsp;catch&nbsp;(</span><span style="color: #0000BB">Error&nbsp;$e</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Error&nbsp;with&nbsp;the&nbsp;provided&nbsp;parameter&nbsp;:&nbsp;&lt;=&nbsp;0<br /></span><span style="color: #007700">}<br /><br /></span>?&gt;</pre><br />
<br />
</p><h2><a href="issues.html?analyzer=Indirect Injection" id="Indirect Injection">Indirect Injection</a></h2><p>[Since 0.8.4] - [ -P Security/IndirectInjection ]</p><p>Look for injections through indirect usage for GPRC values ($_GET, $_POST, $_REQUEST, $_COOKIE). <br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br />$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'a'</span><span style="color: #007700">];<br />echo&nbsp;</span><span style="color: #0000BB">$a</span><span style="color: #007700">;<br /><br /></span>?&gt;</pre></p><h2><a href="issues.html?analyzer=Unserialize Second Arg" id="Unserialize Second Arg">Unserialize Second Arg</a></h2><p>[Since 0.8.4] - [ -P Security/UnserializeSecondArg ] - [ PHP 7.0 and more recent ]</p><p>Since PHP 7, unserialize() function has a second argument that limits the classes that may be unserialized. In case of a breach, this is limiting the classes accessible from unserialize(). <br />
<br />
On way to exploit unserialize, is to make PHP unserialized the data to an available class, may be one that may be auto-loaded.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #FF8000">//&nbsp;safe&nbsp;unserialization&nbsp;:&nbsp;only&nbsp;the&nbsp;expected&nbsp;class&nbsp;will&nbsp;be&nbsp;extracted<br /></span><span style="color: #0000BB">$serialized&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'O:7:dbClass:0:{}'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$var&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">unserialize</span><span style="color: #007700">(</span><span style="color: #0000BB">$serialized</span><span style="color: #007700">,&nbsp;[</span><span style="color: #DD0000">'dbClass'</span><span style="color: #007700">]);<br /></span><span style="color: #0000BB">$var</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//&nbsp;unsafe&nbsp;unserialization&nbsp;:&nbsp;$var&nbsp;may&nbsp;be&nbsp;of&nbsp;any&nbsp;type&nbsp;that&nbsp;was&nbsp;in&nbsp;the&nbsp;serialized&nbsp;string<br />//&nbsp;although,&nbsp;here,&nbsp;this&nbsp;is&nbsp;working&nbsp;well.<br /></span><span style="color: #0000BB">$serialized&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'O:7:dbClass:0:{}'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$var&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">unserialize</span><span style="color: #007700">(</span><span style="color: #0000BB">$serialized</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$var</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect</span><span style="color: #007700">();<br /><br /></span><span style="color: #FF8000">//&nbsp;unsafe&nbsp;unserialization&nbsp;:&nbsp;$var&nbsp;is&nbsp;not&nbsp;of&nbsp;the&nbsp;expected&nbsp;type.<br />//&nbsp;and,&nbsp;here,&nbsp;this&nbsp;will&nbsp;lead&nbsp;to&nbsp;disaster.<br /></span><span style="color: #0000BB">$serialized&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'O:10:debugClass:0:{}'</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$var&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">unserialize</span><span style="color: #007700">(</span><span style="color: #0000BB">$serialized</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$var</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">connect</span><span style="color: #007700">();<br /><br /></span>?&gt;</pre><br />
<br />
See also unserialize(); <br />
</p><h2><a href="issues.html?analyzer=Dont Echo Error" id="Dont Echo Error">Dont Echo Error</a></h2><p>[Since 0.8.7] - [ -P Security/DontEchoError ]</p><p>It is recommended to avoid displaying error messages directly to the browser.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #FF8000">//&nbsp;Inside&nbsp;a&nbsp;'or'&nbsp;test<br /></span><span style="color: #0000BB">mysql_connect</span><span style="color: #007700">(</span><span style="color: #DD0000">'localhost'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$user</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$pass</span><span style="color: #007700">)&nbsp;or&nbsp;die(</span><span style="color: #0000BB">mysql_error</span><span style="color: #007700">());<br /><br /></span><span style="color: #FF8000">//&nbsp;Inside&nbsp;a&nbsp;if&nbsp;test<br /></span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">pg_query</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$db</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$query&nbsp;</span><span style="color: #007700">);<br />if(&nbsp;!</span><span style="color: #0000BB">$result&nbsp;</span><span style="color: #007700">)<br />{<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">Erreur&nbsp;SQL</span><span style="color: #007700">:&nbsp;.&nbsp;</span><span style="color: #0000BB">pg_error</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;exit;<br />}<br /><br /></span>?&gt;</pre><br />
<br />
Error messages should be logged, but not displayed. <br />
<br />
</p><h2><a href="issues.html?analyzer=Should Use session_regenerateid()" id="Should Use session_regenerateid()">Should Use session_regenerateid()</a></h2><p>[Since 0.10.4] - [ -P Security/ShouldUseSessionRegenerateId ]</p><p>session_regenerateid() should be used when sessions are used.<br />
<br />
When using sessions, a session ID is assigned to the user. It is a random number, used to connect the user and its data on the server. Actually, anyone with the session ID may have access to the data. This is why those session ID are so long and complex.<br />
<br />
A good approach to protect the session ID is to reduce its lifespan : the shorter the time of use, the better. While changing the session ID at every hit on the page may no be possible, a more reasonable approach is to change the session id when an important action is about to take place. What important means is left to the application to decide.<br />
<br />
Based on this philopsophy, a code source that uses Zend\Session but never uses Zend\Session::regenerateId() has to be updated.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br />&nbsp;&nbsp;&nbsp;&nbsp;session_start</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$id&nbsp;</span><span style="color: #007700">=&nbsp;(int)&nbsp;</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'id'</span><span style="color: #007700">];<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;no&nbsp;usage&nbsp;of&nbsp;session_regenerateid()&nbsp;anywhere&nbsp;triggers&nbsp;the&nbsp;analysis<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;basic&nbsp;regeneration&nbsp;every&nbsp;20&nbsp;hits&nbsp;on&nbsp;the&nbsp;page.&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">if&nbsp;(++</span><span style="color: #0000BB">$_SESSION</span><span style="color: #007700">[</span><span style="color: #DD0000">'count'</span><span style="color: #007700">]&nbsp;&gt;&nbsp;</span><span style="color: #0000BB">20</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">session_regenerateid</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br /></span>?&gt;</pre><br />
<br />
See <a href="http://php.net/session_regenerate_id" alt="session_regenerateid()">session_regenerateid()</a> and <a href="http://phpsec.org/projects/guide/4.html" alt="PHP Security Guide: Sessions">PHP Security Guide: Sessions</a>.<br />
<br />
</p><h2><a href="issues.html?analyzer=Encoded Simple Letters" id="Encoded Simple Letters">Encoded Simple Letters</a></h2><p>[Since 0.10.5] - [ -P Security/EncodedLetters ]</p><p>Some simple letters are written in escape sequence. <br />
<br />
Usually, escape sequences are made to encode unusual characters. Using escape sequences for simple characters, like letters or numbers is suspicious.<br />
<br />
This analysis also detect unicode codepoint with superfluous leading zeros.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #FF8000">//&nbsp;This&nbsp;escape&nbsp;sequence&nbsp;makes&nbsp;eval&nbsp;hard&nbsp;to&nbsp;spot<br /></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ev</span><span style="color: #007700">\</span><span style="color: #0000BB">101l</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$a</span><span style="color: #007700">(</span><span style="color: #DD0000">'php_info();'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;With&nbsp;a&nbsp;PHP&nbsp;7.0&nbsp;unicode&nbsp;code&nbsp;point&nbsp;sequence<br /></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ev</span><span style="color: #007700">\</span><span style="color: #0000BB">u</span><span style="color: #007700">{</span><span style="color: #0000BB">000041</span><span style="color: #007700">}</span><span style="color: #0000BB">l</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$a</span><span style="color: #007700">(</span><span style="color: #DD0000">'php_info();'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;With&nbsp;a&nbsp;PHP&nbsp;5.0+&nbsp;hexadecimal&nbsp;sequence<br /></span><span style="color: #0000BB">$a&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">ev</span><span style="color: #007700">\</span><span style="color: #0000BB">x41l</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$a</span><span style="color: #007700">(</span><span style="color: #DD0000">'php_info();'</span><span style="color: #007700">);<br /><br /></span>?&gt;</pre><br />
</p><h2><a href="issues.html?analyzer=Set Cookie Safe Arguments" id="Set Cookie Safe Arguments">Set Cookie Safe Arguments</a></h2><p>[Since 0.10.6] - [ -P Security/SetCookieArgs ]</p><p>The last five arguments of setcookie() and setrawcookie() are for security. Use them anytime you can.<br />
<br />
setcookie ( string $name [, string $value =  [, int $expire = 0 [, string $path =  [, string $domain =  [, bool $secure = false [, bool $httponly = false ]]]]]] )<br />
<br />
The $expire argument sets the date of expiration of the cookie. It is recommended to make it as low as possible, to reduce its chances to be captured. Sometimes, low expiration date may be several days (for preferences), and other times, low expiration date means a few minutes. <br />
<br />
The $path argument limits the transmission of the cookie to URL whose path matches the one mentionned here. By default, it is '/', which means the whole server. If a cookie usage is limited to a part of the application, use it here.<br />
<br />
The $domain argument limits the transmission of the cookie to URL whose domain matches the one mentionned here. By default, it is '', which means any server on the internet. At worse, you may use 'mydomain.com' to cover your whole domain, or better, refine it with the actual subdomain of usage.<br />
<br />
The $secure argument limits the transmission of the cookie over HTTP (by default) or HTTPS. The second is better, as the transmission of the cookie is crypted. In case HTTPS is still at the planned stage, use '$_SERVER[HTTPS]'. This environnement variable is false on HTTP, and true on HTTPS.<br />
<br />
The $httponly argument limits the access of the cookie to Javascript. It is only transmitted to the browser, and retransmitted. This helps reducing XSS and CSRF attacks, though it is disputed. <br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #FF8000">//admin&nbsp;cookie,&nbsp;available&nbsp;only&nbsp;on&nbsp;https://admin.my-domain.com/system/,&nbsp;for&nbsp;the&nbsp;next&nbsp;minute,&nbsp;and&nbsp;not&nbsp;readable&nbsp;by&nbsp;javascript<br /></span><span style="color: #0000BB">setcookie</span><span style="color: #007700">(</span><span style="color: #0000BB">admin</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$login</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">time</span><span style="color: #007700">()+</span><span style="color: #0000BB">60</span><span style="color: #007700">,&nbsp;/</span><span style="color: #0000BB">system</span><span style="color: #007700">/,&nbsp;</span><span style="color: #0000BB">admin</span><span style="color: #007700">.</span><span style="color: #0000BB">my</span><span style="color: #007700">-</span><span style="color: #0000BB">domain</span><span style="color: #007700">.</span><span style="color: #0000BB">com</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">'HTTPS'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//login&nbsp;cookie,&nbsp;available&nbsp;until&nbsp;the&nbsp;browser&nbsp;is&nbsp;closed,&nbsp;over&nbsp;http&nbsp;or&nbsp;https<br /></span><span style="color: #0000BB">setcookie</span><span style="color: #007700">(</span><span style="color: #0000BB">login</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$login</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//removing&nbsp;the&nbsp;login&nbsp;cookie&nbsp;:&nbsp;Those&nbsp;situations&nbsp;are&nbsp;omitted&nbsp;by&nbsp;the&nbsp;analysis<br /></span><span style="color: #0000BB">setcookie</span><span style="color: #007700">(</span><span style="color: #0000BB">login</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">);<br /><br /></span>?&gt;</pre><br />
<br />
See also setcookie() on the manual for more information.<br />
<br />
</p><h2><a href="issues.html?analyzer=No Return Or Throw In Finally" id="No Return Or Throw In Finally">No Return Or Throw In Finally</a></h2><p>[Since 0.12.1] - [ -P Structures/NoReturnInFinally ]</p><p>Avoid using return and throw in a finally block. Both command will interrupt the processing of the try catch block, and any exception that was emitted will not be processed. This leads to unprocessed exceptions, leaving the application in an unstable state.<br />
<br />
Note that PHP prevents the usage of goto, break and continue within the finally block at linting phase. This is categorized as a Security problem.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">foo</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Exception&nbsp;is&nbsp;thrown&nbsp;here&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">throw&nbsp;new&nbsp;\</span><span style="color: #0000BB">Exception</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(</span><span style="color: #0000BB">Exception&nbsp;$e</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;This&nbsp;is&nbsp;executed&nbsp;AFTER&nbsp;finally<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #DD0000">'Exception'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;finally&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;This&nbsp;is&nbsp;executed&nbsp;BEFORE&nbsp;catch<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #DD0000">'Finally'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Displays&nbsp;'Finally'.&nbsp;No&nbsp;exception<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">foo</span><span style="color: #007700">();<br /><br />function&nbsp;</span><span style="color: #0000BB">bar</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;try&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Exception&nbsp;is&nbsp;thrown&nbsp;here&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">throw&nbsp;new&nbsp;\</span><span style="color: #0000BB">Exception</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;catch&nbsp;(</span><span style="color: #0000BB">Exception&nbsp;$e</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Process&nbsp;the&nbsp;exception.&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #DD0000">'Exception'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;finally&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;clean&nbsp;the&nbsp;current&nbsp;situation<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Keep&nbsp;running&nbsp;the&nbsp;current&nbsp;function<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">}<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">'Finally'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Displays&nbsp;'Exception',&nbsp;with&nbsp;processed&nbsp;Exception<br /></span><span style="color: #007700">echo&nbsp;</span><span style="color: #0000BB">bar</span><span style="color: #007700">();<br /><br /></span>?&gt;</pre><br />
<br />
See also <a href="https://www.owasp.org/index.php/Return_Inside_Finally_Block" alt="Return Inside Finally Block">Return Inside Finally Block</a>.<br />
 </p><h2><a href="issues.html?analyzer=Mkdir Default" id="Mkdir Default">Mkdir Default</a></h2><p>[Since 0.12.2] - [ -P Security/MkdirDefault ]</p><p>mkdir() gives universal access to created folders, by default. It is recommended to gives a more limited set of rights (0755, 0700), or to explicitely set the rights to 0777. <br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #FF8000">//&nbsp;By&nbsp;default,&nbsp;this&nbsp;dir&nbsp;is&nbsp;777<br /></span><span style="color: #0000BB">mkdir</span><span style="color: #007700">(</span><span style="color: #DD0000">'/path/to/dir'</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Explicitely,&nbsp;this&nbsp;is&nbsp;wanted.&nbsp;It&nbsp;may&nbsp;also&nbsp;be&nbsp;audited&nbsp;easily<br /></span><span style="color: #0000BB">mkdir</span><span style="color: #007700">(</span><span style="color: #DD0000">'/path/to/dir'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0777</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;This&nbsp;dir&nbsp;is&nbsp;limited&nbsp;to&nbsp;the&nbsp;current&nbsp;user.&nbsp;<br /></span><span style="color: #0000BB">mkdir</span><span style="color: #007700">(</span><span style="color: #DD0000">'/path/to/dir'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">0700</span><span style="color: #007700">);<br /><br /></span>?&gt;</pre><br />
<br />
See also <a href="https://www.spiralscripts.co.uk/Blog/why-777-folder-permissions-are-a-security-risk.html" alt="Why 777 Folder Permissions are a Security Risk">Why 777 Folder Permissions are a Security Risk</a>.<br />
</p><h2><a href="issues.html?analyzer=Switch Fallthrough" id="Switch Fallthrough">Switch Fallthrough</a></h2><p>[Since 0.12.14] - [ -P Structures/Fallthrough ]</p><p>A switch with fallthrough is prone to errors. <br />
<br />
A fallthrough happens when a case or default clause in a switch statement is not finished by a break (or equivalent);<br />
CWE report this as a security concern, unless well documented.<br />
<br />
A fallthrough may be used as a feature. Then, it is undistinguisable from an error. <br />
<br />
When the case block is empty, this analysis doesn't report it : the case is then used as an alias.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /></span><span style="color: #007700">switch(</span><span style="color: #0000BB">$variable</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #0000BB">1&nbsp;</span><span style="color: #007700">:&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;1&nbsp;is&nbsp;not&nbsp;reported,&nbsp;as&nbsp;it&nbsp;actually&nbsp;shares&nbsp;the&nbsp;same&nbsp;body&nbsp;as&nbsp;33<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">case&nbsp;</span><span style="color: #0000BB">33&nbsp;</span><span style="color: #007700">:&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break&nbsp;;<br />&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #0000BB">2&nbsp;</span><span style="color: #007700">:&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break&nbsp;;<br />&nbsp;&nbsp;&nbsp;&nbsp;default:&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++</span><span style="color: #0000BB">$a</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;</span><span style="color: #0000BB">4&nbsp;</span><span style="color: #007700">:&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;break&nbsp;;<br />}<br /></span>?&gt;</pre><br />
<br />
This analysis cannot take into account comments about the fallthough. <br />
<br />
See also <a href="https://cwe.mitre.org/data/definitions/484.html" alt="CWE-484: Omitted Break Statement in Switch">CWE-484: Omitted Break Statement in Switch</a> and <br />
         <a href="https://palantir.github.io/tslint/rules/no-switch-case-fall-through/" alt="Rule: no-switch-case-fall-through">Rule: no-switch-case-fall-through</a>.<br />
</p><h2><a href="issues.html?analyzer=Upload Filename Injection" id="Upload Filename Injection">Upload Filename Injection</a></h2><p>[Since 0.12.14] - [ -P Security/UploadFilenameInjection ]</p><p>When receiving a file via Upload, it is recommended to store it under a self-generated name. Any storage that uses the original filename, or even a part of it may be vulnerable to injections.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #FF8000">//&nbsp;Security&nbsp;error&nbsp;!&nbsp;the&nbsp;$_FILES['upload']['filename']&nbsp;is&nbsp;provided&nbsp;by&nbsp;the&nbsp;sender.<br />//&nbsp;'a.&lt;script&gt;alert(\'a\')&lt;/script&gt;';&nbsp;may&nbsp;lead&nbsp;to&nbsp;a&nbsp;HTML&nbsp;injection.<br /></span><span style="color: #0000BB">$extension&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">substr</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">strrchr</span><span style="color: #007700">(</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">'upload'</span><span style="color: #007700">][</span><span style="color: #DD0000">'name'</span><span style="color: #007700">],&nbsp;</span><span style="color: #DD0000">'.'</span><span style="color: #007700">)&nbsp;,</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br />if&nbsp;(!</span><span style="color: #0000BB">in_array</span><span style="color: #007700">(</span><span style="color: #0000BB">$extension</span><span style="color: #007700">,&nbsp;array(</span><span style="color: #DD0000">'gif'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'jpeg'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">'jpg'</span><span style="color: #007700">))&nbsp;{&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;process&nbsp;error<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">continue;<br />}<br /></span><span style="color: #FF8000">//&nbsp;Md5&nbsp;provides&nbsp;a&nbsp;name&nbsp;without&nbsp;special&nbsp;characters<br /></span><span style="color: #0000BB">$name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">md5</span><span style="color: #007700">(</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">'upload'</span><span style="color: #007700">][</span><span style="color: #DD0000">'filename'</span><span style="color: #007700">]);<br />if(@</span><span style="color: #0000BB">move_uploaded_file</span><span style="color: #007700">(</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">'upload'</span><span style="color: #007700">][</span><span style="color: #DD0000">'tmp_name'</span><span style="color: #007700">],&nbsp;</span><span style="color: #DD0000">'/var/no-www/upload/'</span><span style="color: #007700">.</span><span style="color: #0000BB">$name</span><span style="color: #007700">.</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$extension</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">safeStoring</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">.</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$extension</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">'upload'</span><span style="color: #007700">][</span><span style="color: #DD0000">'filename'</span><span style="color: #007700">]);<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Security&nbsp;error&nbsp;!&nbsp;the&nbsp;$_FILES['upload']['filename']&nbsp;is&nbsp;provided&nbsp;by&nbsp;the&nbsp;sender.<br /></span><span style="color: #007700">if(@</span><span style="color: #0000BB">move_uploaded_file</span><span style="color: #007700">(</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">'upload'</span><span style="color: #007700">][</span><span style="color: #DD0000">'tmp_name'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">'upload'</span><span style="color: #007700">][</span><span style="color: #DD0000">'filename'</span><span style="color: #007700">]))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">safeStoring</span><span style="color: #007700">(</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">'upload'</span><span style="color: #007700">][</span><span style="color: #DD0000">'filename'</span><span style="color: #007700">]);<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Security&nbsp;error&nbsp;!&nbsp;the&nbsp;$_FILES['upload']['filename']&nbsp;is&nbsp;provided&nbsp;by&nbsp;the&nbsp;sender.<br />//&nbsp;'a.&lt;script&gt;alert('a')&lt;/script&gt;';&nbsp;may&nbsp;lead&nbsp;to&nbsp;a&nbsp;HTML&nbsp;injection.<br /></span><span style="color: #0000BB">$extension&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">substr</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">strrchr</span><span style="color: #007700">(</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">'upload'</span><span style="color: #007700">][</span><span style="color: #DD0000">'name'</span><span style="color: #007700">],&nbsp;</span><span style="color: #DD0000">'.'</span><span style="color: #007700">)&nbsp;,</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">$name&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">md5</span><span style="color: #007700">(</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">'upload'</span><span style="color: #007700">][</span><span style="color: #DD0000">'filename'</span><span style="color: #007700">]);<br />if(@</span><span style="color: #0000BB">move_uploaded_file</span><span style="color: #007700">(</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">'upload'</span><span style="color: #007700">][</span><span style="color: #DD0000">'tmp_name'</span><span style="color: #007700">],&nbsp;</span><span style="color: #0000BB">$name</span><span style="color: #007700">.</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$extension</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">safeStoring</span><span style="color: #007700">(</span><span style="color: #0000BB">$name</span><span style="color: #007700">.</span><span style="color: #DD0000">'.'</span><span style="color: #007700">.</span><span style="color: #0000BB">$extension</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$_FILES</span><span style="color: #007700">[</span><span style="color: #DD0000">'upload'</span><span style="color: #007700">][</span><span style="color: #DD0000">'filename'</span><span style="color: #007700">]);<br />}<br /><br /></span>?&gt;</pre><br />
<br />
It is highly recommended to validate any incoming file, generate a name for it, and store the result in a folder outside the web folder. Also, avoid accepting PHP scripts, if possible.<br />
<br />
See also <a href="https://cxsecurity.com/issue/WLB-2017100031" alt="[CVE-2017-6090]">[CVE-2017-6090]</a>, <br />
<a href="https://cwe.mitre.org/data/definitions/616.html" alt="CWE-616: Incomplete Identification of Uploaded File Variables">CWE-616: Incomplete Identification of Uploaded File Variables</a>, <br />
<a href="https://www.acunetix.com/websitesecurity/upload-forms-threat/" alt="Why File Upload Forms are a Major Security Threat">Why File Upload Forms are a Major Security Threat</a>.<br />
</p><h2><a href="issues.html?analyzer=Always Anchor Regex" id="Always Anchor Regex">Always Anchor Regex</a></h2><p>[Since 0.12.15] - [ -P Security/AnchorRegex ]</p><p>Unanchored regex finds the requested pattern, and leaves room for malicious content. <br />
<br />
Without ^ and $, the regex is searches for any pattern that satisfies its criteria, leaving any unused part of the string available for abitrary content. It is recommended to use both anchor<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br />$birthday&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">getSomeDate</span><span style="color: #007700">(</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">//&nbsp;Permissive&nbsp;version&nbsp;:&nbsp;$birthday&nbsp;=&nbsp;'1970-01-01&lt;script&gt;xss();&lt;/script&gt;';<br /></span><span style="color: #007700">if&nbsp;(!</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">'/\d{4}-\d{2}-\d{2}/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$birthday</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">error</span><span style="color: #007700">(</span><span style="color: #DD0000">'Wrong&nbsp;data&nbsp;format&nbsp;for&nbsp;your&nbsp;birthday!'</span><span style="color: #007700">);<br />}<br /><br /></span><span style="color: #FF8000">//&nbsp;Restrictive&nbsp;version&nbsp;:&nbsp;$birthday&nbsp;=&nbsp;'1970-01-01';<br /></span><span style="color: #007700">if&nbsp;(!</span><span style="color: #0000BB">preg_match</span><span style="color: #007700">(</span><span style="color: #DD0000">'/^\d{4}-\d{2}-\d{2}$/'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$birthday</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">error</span><span style="color: #007700">(</span><span style="color: #DD0000">'Wrong&nbsp;data&nbsp;format&nbsp;for&nbsp;your&nbsp;birthday!'</span><span style="color: #007700">);<br />}<br /><br />echo&nbsp;</span><span style="color: #DD0000">'Your&nbsp;birthday&nbsp;is&nbsp;on&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$birthday</span><span style="color: #007700">;<br /><br /></span>?&gt;</pre><br />
<br />
Note that $ may be a line ending, still leaving room after it for injection.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br />$birthday&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'1970-01-01'</span><span style="color: #007700">.</span><span style="color: #0000BB">PHP_EOL</span><span style="color: #007700">.</span><span style="color: #DD0000">'&lt;script&gt;xss();&lt;/script&gt;'</span><span style="color: #007700">;<br /><br /></span>?&gt;</pre><br />
<br />
This analysis reports false positive when the regex is used to search a pattern in a much larger string. Check if this rule doesn't apply, though.<br />
<br />
See also <a href="https://cwe.mitre.org/data/definitions/625.html" alt="CWE-625: Permissive Regular Expression">CWE-625: Permissive Regular Expression</a>.<br />
<br />
</p><h2><a href="issues.html?analyzer=Session Lazy Write" id="Session Lazy Write">Session Lazy Write</a></h2><p>[Since 0.12.15] - [ -P Security/SessionLazyWrite ]</p><p>Classes that implements SessionHandlerInterface must also implements SessionUpdateTimestampHandlerInterface. <br />
<br />
The two extra methods are used to help lazy loading : the first actually checks if a sessionId is available, and the seconds updates the time of last usage of the session data in the session storage. <br />
<br />
This was spotted by Nicolas Grekas, and fixed in Symfony <a href="https://github.com/symfony/symfony/pull/24523" alt="[HttpFoundation] Make sessions secure and lazy #24523">[HttpFoundation] Make sessions secure and lazy #24523</a>. <br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #007700">interface&nbsp;</span><span style="color: #0000BB">SessionUpdateTimestampHandlerInterface&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;returns&nbsp;a&nbsp;boolean&nbsp;to&nbsp;indicate&nbsp;that&nbsp;valid&nbsp;data&nbsp;is&nbsp;available&nbsp;for&nbsp;this&nbsp;sessionId,&nbsp;or&nbsp;not.<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">validateId</span><span style="color: #007700">(</span><span style="color: #0000BB">$sessionId</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//called&nbsp;to&nbsp;change&nbsp;the&nbsp;last&nbsp;time&nbsp;of&nbsp;usage&nbsp;for&nbsp;the&nbsp;session&nbsp;data.<br />&nbsp;&nbsp;&nbsp;&nbsp;//It&nbsp;may&nbsp;be&nbsp;a&nbsp;file's&nbsp;touch&nbsp;or&nbsp;full&nbsp;write,&nbsp;or&nbsp;a&nbsp;simple&nbsp;update&nbsp;on&nbsp;the&nbsp;database<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">updateTimestamp</span><span style="color: #007700">(</span><span style="color: #0000BB">$sessionId</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sessionData</span><span style="color: #007700">);<br />}<br /><br /></span>?&gt;</pre><br />
<br />
See also <a href="http://php.net/manual/en/book.session.php" alt=" <https://wiki.php.net/rfc/session-read_only-lazy_write><a href="https://wiki.php.net/rfc/session-read_only-lazy_write" alt="_ and the <a href="br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Avoid&nbsp;using&nbsp;incoming&nbsp;data&nbsp;to&nbsp;build&nbsp;the&nbsp;eval()&nbsp;expression&nbsp;:&nbsp;any&nbsp;filtering&nbsp;error&nbsp;leads&nbsp;to&nbsp;PHP&nbsp;injection<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$mathExpression&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">$_GET</span><span style="color: #007700">[</span><span style="color: #DD0000">'mathExpression'</span><span style="color: #007700">];&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$mathExpression&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'#[^0-9+\-*/\(/)]#is'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$mathExpression</span><span style="color: #007700">);&nbsp;</span><span style="color: #FF8000">//&nbsp;expecting&nbsp;1+2<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$literalCode&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'$a&nbsp;=&nbsp;'</span><span style="color: #007700">.</span><span style="color: #0000BB">$mathExpression</span><span style="color: #007700">.</span><span style="color: #DD0000">';'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;eval(</span><span style="color: #0000BB">$literalCode</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;echo&nbsp;</span><span style="color: #0000BB">$a</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;If&nbsp;eval'ed&nbsp;code&nbsp;is&nbsp;known&nbsp;at&nbsp;compile&nbsp;time,&nbsp;it&nbsp;is&nbsp;best&nbsp;to&nbsp;put&nbsp;it&nbsp;inline<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$literalCode&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'phpinfo();'</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;eval(</span><span style="color: #0000BB">$literalCode</span><span style="color: #007700">);<br /><br /></span>?&gt;</pre><br />
<br />
Most of the time, it is possible to replace the code by some standard PHP, like variable variable for accessing a variable for which you have the name.<br />
At worse, including a pre-generated file will be faster. <br />
<br />
For PHP 7.0 and later, it is important to put eval() in a try..catch expression.<br />
</p><p>This rule is named <a target="_blank" href="https://github.com/dseguy/clearPHP/blob/master/rules/no-eval.md">no-eval</a>, in the clearPHP reference.</p><h2><a href="issues.html?analyzer=eval() Without Try" id="eval() Without Try">eval() Without Try</a></h2><p>[Since 0.8.4] - [ -P Structures/EvalWithoutTry ] - [ PHP 7.0 and more recent ]</p><p>eval() emits a ParseError exception with PHP 7 and later. Catching this exception is the recommended way to handle errors when using the eval() function.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br />$code&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'This&nbsp;is&nbsp;no&nbsp;PHP&nbsp;code.'</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//PHP&nbsp;5&nbsp;style<br /></span><span style="color: #007700">eval(</span><span style="color: #0000BB">$code</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">//&nbsp;Ends&nbsp;up&nbsp;with&nbsp;a&nbsp;Fatal&nbsp;error,&nbsp;at&nbsp;execution&nbsp;time<br /><br />//PHP&nbsp;7&nbsp;style<br /></span><span style="color: #007700">try&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;eval(</span><span style="color: #0000BB">$code</span><span style="color: #007700">);<br />}&nbsp;catch&nbsp;(</span><span style="color: #0000BB">ParseError&nbsp;$e</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">cleanUpAfterEval</span><span style="color: #007700">();<br />}<br /><br /></span>?&gt;</pre><br />
<br />
Note that it will catch situations where eval() is provided with code that can't be used, but it will not catch security problems. Avoid using eval() with incoming data.<br />
</p><h2><a href="issues.html?analyzer=Phpinfo" id="Phpinfo">Phpinfo</a></h2><p>[Since 0.8.4] - [ -P Structures/PhpinfoUsage ]</p><p>phpinfo() is a great function to learn about the current configuration of the server.<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #007700">if&nbsp;(</span><span style="color: #0000BB">DEBUG</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">phpinfo</span><span style="color: #007700">();<br />}<br /><br /></span>?&gt;</pre><br />
<br />
If left in the production code, it may lead to a critical leak, as any attacker gaining access to this data will know a lot about the server configuration.<br />
It is advised to never leave that kind of instruction in a production code. <br />
</p><h2><a href="issues.html?analyzer=Sqlite3 Requires Single Quotes" id="Sqlite3 Requires Single Quotes">Sqlite3 Requires Single Quotes</a></h2><p>[Since 1.0.10] - [ -P Security/Sqlite3RequiresSingleQuotes ]</p><p>The escapeString() method from Sqlite3 doesn't escape ", but only '. <br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br /></span><span style="color: #FF8000">//&nbsp;OK.&nbsp;escapeString&nbsp;is&nbsp;OK&nbsp;with&nbsp;'<br /></span><span style="color: #0000BB">$query&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"SELECT&nbsp;*&nbsp;FROM&nbsp;table&nbsp;WHERE&nbsp;col&nbsp;=&nbsp;'"</span><span style="color: #007700">.</span><span style="color: #0000BB">$sqlite</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">escapeString</span><span style="color: #007700">(</span><span style="color: #0000BB">$x</span><span style="color: #007700">).</span><span style="color: #DD0000">"'"</span><span style="color: #007700">;<br /><br /></span><span style="color: #FF8000">//&nbsp;This&nbsp;is&nbsp;vulnerable&nbsp;to&nbsp;"&nbsp;in&nbsp;$x<br /></span><span style="color: #0000BB">$query&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'SELECT&nbsp;*&nbsp;FROM&nbsp;table&nbsp;WHERE&nbsp;col&nbsp;=&nbsp;"'</span><span style="color: #007700">.</span><span style="color: #0000BB">$sqlite</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">escapeString</span><span style="color: #007700">(</span><span style="color: #0000BB">$x</span><span style="color: #007700">).</span><span style="color: #DD0000">'"'</span><span style="color: #007700">;<br /><br /></span>?&gt;</pre><br />
<br />
To properly handle quotes and NUL characters, use bindParam() instead.<br />
<br />
Quote from the PHP manual comments : The reason this function doesn't escape double quotes is because double quotes are used with names (the equivalent of backticks in MySQL), as in table or column names, while single quotes are used for values.<br />
<br />
See also <a href="http://php.net/manual/en/sqlite3.escapestring.php" alt="Sessions">">_ and the <a href="br />
<br />
See also `XML External Entity <https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/XXE%20injections" alt="SQLite3::escapeString">SQLite3::escapeString</a>, <br />
         <a href="https://www.owasp.org/index.php/XML_External_Entity_(XXE)_Processing" alt="XML External Entity (XXE) Processing">XML External Entity (XXE) Processing</a> and <br />
         <a href="https://web-in-security.blogspot.nl/2014/11/detecting-and-exploiting-xxe-in-saml.html" alt="Detecting and exploiting XXE in SAML Interfaces">Detecting and exploiting XXE in SAML Interfaces</a>.<br />
 </p><h2><a href="issues.html?analyzer=Dynamic Library Loading" id="Dynamic Library Loading">Dynamic Library Loading</a></h2><p>[Since 1.1.7] - [ -P Security/DynamicDl ]</p><p>Loading a variable dynamically requires a lot of care in the preparation of the library name. <br />
<br />
In case of injection in the variable, the dynamic loading of a library gives a lot of power to an intruder. <br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php <br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;dynamically&nbsp;loading&nbsp;a&nbsp;library<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">dl</span><span style="color: #007700">(</span><span style="color: #0000BB">$library</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">PHP_SHLIB_SUFFIX</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;dynamically&nbsp;loading&nbsp;ext/vips<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">dl</span><span style="color: #007700">(</span><span style="color: #DD0000">'vips.'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">PHP_SHLIB_SUFFIX</span><span style="color: #007700">);<br /><br /></span>?&gt;</pre><br />
<br />
See also `dl <http://www.php.net/dl" alt="Sessions"></a> and the `Sessions</a>.<br />
</p><h2><a href="issues.html?analyzer=Eval() Usage" id="Eval() Usage">Eval() Usage</a></h2><p>[Since 0.8.4] - [ -P Structures/EvalUsage ]</p><p>Using eval() is bad for performances (compilation time), for caches (it won't be compiled), and for security (if it includes external data).<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php">Sessions">">_ and the `Sessions"></a> and the `Sessions</a>.<br />
</p><h2><a href="issues.html?analyzer=Eval() Usage" id="Eval() Usage">Eval() Usage</a></h2><p>[Since 0.8.4] - [ -P Structures/EvalUsage ]</p><p>Using eval() is bad for performances (compilation time), for caches (it won't be compiled), and for security (if it includes external data).<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php</a>.<br />
</p><h2><a href="issues.html?analyzer=No Net For Xml Load" id="No Net For Xml Load">No Net For Xml Load</a></h2><p>[Since 1.0.11] - [ -P Security/NoNetForXmlLoad ]</p><p>Simplexml and ext/DOM load all external entities on the web, by default. This is dangerous, when loading unknown XML code.<br />
<br />
<?literal<br />
<br />
<!DOCTYPE replace [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=index.php"> ]><br />
<replace>&xxe;</replace><br />
<br />
?><br />
<br />
Here, PHP tries to load the XML file, find the entity, then solves the entity by encoding a file called 'index.php'. The source code of the file is not used as data in the xml file.">Sessions"></a> and the `Sessions</a>.<br />
</p><h2><a href="issues.html?analyzer=Eval() Usage" id="Eval() Usage">Eval() Usage</a></h2><p>[Since 0.8.4] - [ -P Structures/EvalUsage ]</p><p>Using eval() is bad for performances (compilation time), for caches (it won't be compiled), and for security (if it includes external data).<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php">Sessions">">_ and the `Sessions"></a> and the `Sessions</a>.<br />
</p><h2><a href="issues.html?analyzer=Eval() Usage" id="Eval() Usage">Eval() Usage</a></h2><p>[Since 0.8.4] - [ -P Structures/EvalUsage ]</p><p>Using eval() is bad for performances (compilation time), for caches (it won't be compiled), and for security (if it includes external data).<br />
<br />
<pre style="border: 1px solid #ddd; background-color: #f5f5f5;">&lt;?php</a>.<br />
</p><h2><a href="issues.html?analyzer=No Net For Xml Load" id="No Net For Xml Load">No Net For Xml Load</a></h2><p>[Since 1.0.11] - [ -P Security/NoNetForXmlLoad ]</p><p>Simplexml and ext/DOM load all external entities on the web, by default. This is dangerous, when loading unknown XML code.<br />
<br />
<?literal<br />
<br />
<!DOCTYPE replace [<!ENTITY xxe SYSTEM "php://filter/convert.base64-encode/resource=index.php"> ]><br />
<replace>&xxe;</replace><br />
<br />
?><br />
<br />
Here, PHP tries to load the XML file, find the entity, then solves the entity by encoding a file called 'index.php'. The source code of the file is not used as data in the xml file.</a>.<br />
</p>
                </div>
              </div>
            </div>
          </div>
        </section>
        <!-- /.content -->
      </div>
    </div>
    <!-- /.content-wrapper -->

    <!-- Main Footer -->
    <footer class="main-footer">
      <!-- To the right -->
      <div class="pull-right hidden-xs">
        <span class="logo-exakat">
          <img src="images/logo.png" alt="Exakat">
          An <a href="https://www.exakat.io" title="exakat">Exakat</a> report
        </span>
      </div>
      <!-- Default to the left -->
<strong>.</strong>
      
    </footer>

    <!-- Control Sidebar -->
    <aside class="control-sidebar control-sidebar-dark">
      <!-- Create the tabs -->
      <ul class="nav nav-tabs nav-justified control-sidebar-tabs">
        <li class="active"><a href="#control-sidebar-home-tab" data-toggle="tab"><i class="fa fa-home"></i></a></li>
        <li><a href="#control-sidebar-settings-tab" data-toggle="tab"><i class="fa fa-gears"></i></a></li>
      </ul>
    </aside>
    <!-- /.control-sidebar -->
    <!-- Add the sidebar's background. This div must be placed
         immediately after the control sidebar -->
    <div class="control-sidebar-bg"></div>
  </div>
  <!-- ./wrapper -->

  <script src="scripts/vendor.js"></script>
  <script src="scripts/exakat.js"></script>
  <script src="scripts/facetedsearch.js"></script>
  <script src="scripts/highlight.pack.js"></script>

</body>
</html>
        
